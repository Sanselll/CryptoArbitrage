import json

# Raw JSON strings (one per line from your input)
raw_data = """{"timestamp": "2025-11-08T09:15:28.992598Z", "user_id": null, "request": {"opportunities": [{"symbol": "0GUSDT", "long_funding_rate": -0.01, "short_funding_rate": -0.0075, "long_funding_interval_hours": 1, "short_funding_interval_hours": 8, "fund_profit_8h": 7.25, "fund_profit8h24h_proj": 1.8782521, "fund_profit8h3d_proj": 0.7896925, "fund_apr": 7938.75, "fund_apr24h_proj": 2056.686, "fund_apr3d_proj": 864.7133, "spread30_sample_avg": -2.8498669, "price_spread24h_avg": -1.1655372, "price_spread3d_avg": -0.6889304, "spread_volatility_stddev": 0.29677403, "volume_24h": 93962380, "bid_ask_spread_percent": 0.3409246, "orderbook_depth_usd": 90863.914, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "AIAUSDT", "long_funding_rate": -0.00428954, "short_funding_rate": -0.015, "long_funding_interval_hours": 1, "short_funding_interval_hours": 8, "fund_profit_8h": 1.931632, "fund_profit8h24h_proj": 7.878895, "fund_profit8h3d_proj": 3.9909797, "fund_apr": 2115.137, "fund_apr24h_proj": 8627.39, "fund_apr3d_proj": 4370.123, "spread30_sample_avg": -8.943869, "price_spread24h_avg": -9.850927, "price_spread3d_avg": -4.270448, "spread_volatility_stddev": 0.3818255, "volume_24h": 65745556, "bid_ask_spread_percent": 0.11285024, "orderbook_depth_usd": 16483.072, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "FLUXUSDT", "long_funding_rate": -0.01025139, "short_funding_rate": -0.00659199, "long_funding_interval_hours": 4, "short_funding_interval_hours": 8, "fund_profit_8h": 1.391079, "fund_profit8h24h_proj": 0.084708, "fund_profit8h3d_proj": -0.0042639445, "fund_apr": 1523.2314, "fund_apr24h_proj": 92.75526, "fund_apr3d_proj": -4.669019, "spread30_sample_avg": -0.23150457, "price_spread24h_avg": -0.1689354, "price_spread3d_avg": -0.09637102, "spread_volatility_stddev": 0.2860738, "volume_24h": 452874800, "bid_ask_spread_percent": 0.051295202, "orderbook_depth_usd": 72182.05, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "MERLUSDT", "long_funding_rate": -0.00204464, "short_funding_rate": -0.00563384, "long_funding_interval_hours": 1, "short_funding_interval_hours": 8, "fund_profit_8h": 1.072328, "fund_profit8h24h_proj": 2.7224557, "fund_profit8h3d_proj": 2.9290707, "fund_apr": 1174.1992, "fund_apr24h_proj": 2981.089, "fund_apr3d_proj": 3207.3323, "spread30_sample_avg": -0.17261714, "price_spread24h_avg": 0.120973825, "price_spread3d_avg": 0.08450526, "spread_volatility_stddev": 0.10706625, "volume_24h": 134890240, "bid_ask_spread_percent": 0.038993005, "orderbook_depth_usd": 14413.587, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "SOONUSDT", "long_funding_rate": -0.01125, "short_funding_rate": -0.00104743, "long_funding_interval_hours": 8, "short_funding_interval_hours": 8, "fund_profit_8h": 1.020257, "fund_profit8h24h_proj": 0.6055696, "fund_profit8h3d_proj": 0.26953945, "fund_apr": 1117.1814, "fund_apr24h_proj": 663.09875, "fund_apr3d_proj": 295.1457, "spread30_sample_avg": 1.7590183, "price_spread24h_avg": 2.0041146, "price_spread3d_avg": 1.190981, "spread_volatility_stddev": 0.19855553, "volume_24h": 105226440, "bid_ask_spread_percent": 0.3424575, "orderbook_depth_usd": 55511.793, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "WALUSDT", "long_funding_rate": -0.00466247, "short_funding_rate": -0.00056954, "long_funding_interval_hours": 8, "short_funding_interval_hours": 8, "fund_profit_8h": 0.409293, "fund_profit8h24h_proj": 0.10784275, "fund_profit8h3d_proj": 0.042258263, "fund_apr": 448.17584, "fund_apr24h_proj": 118.087814, "fund_apr3d_proj": 46.2728, "spread30_sample_avg": 0.25967878, "price_spread24h_avg": 0.03526062, "price_spread3d_avg": 0.05178217, "spread_volatility_stddev": 0.09884827, "volume_24h": 132136730, "bid_ask_spread_percent": 0.24086712, "orderbook_depth_usd": 135104.72, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "AVAAIUSDT", "long_funding_rate": 0.0004452, "short_funding_rate": 0.00288754, "long_funding_interval_hours": 4, "short_funding_interval_hours": 8, "fund_profit_8h": 0.199714, "fund_profit8h24h_proj": 0.13851933, "fund_profit8h3d_proj": 0.11735874, "fund_apr": 218.68683, "fund_apr24h_proj": 151.67867, "fund_apr3d_proj": 128.50781, "spread30_sample_avg": -0.16139038, "price_spread24h_avg": 0.009811397, "price_spread3d_avg": 0.045419563, "spread_volatility_stddev": 0.08041438, "volume_24h": 121561920, "bid_ask_spread_percent": 0.2773925, "orderbook_depth_usd": 23692.963, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}, {"symbol": "RESOLVUSDT", "long_funding_rate": 5e-05, "short_funding_rate": -0.00072168, "long_funding_interval_hours": 4, "short_funding_interval_hours": 8, "fund_profit_8h": -0.082168, "fund_profit8h24h_proj": -0.0230215, "fund_profit8h3d_proj": 0.20576009, "fund_apr": -89.97396, "fund_apr24h_proj": -25.208542, "fund_apr3d_proj": 225.3073, "spread30_sample_avg": -0.50545406, "price_spread24h_avg": -0.11293645, "price_spread3d_avg": -0.29282898, "spread_volatility_stddev": 0.7114164, "volume_24h": 382238880, "bid_ask_spread_percent": 0.031583935, "orderbook_depth_usd": 57403.777, "estimated_profit_percentage": 0, "position_cost_percent": 0.16, "has_existing_position": false}], "portfolio": {"capital": 14005.96546969, "initial_capital": 14005.96546969, "num_positions": 0, "margin_utilization": 0, "avg_position_pnl_pct": 0, "total_pnl_pct": 0, "drawdown": 0, "episode_progress": 0, "min_liquidation_distance": 1, "capital_utilization": 0, "positions": [{"unrealized_pnl_pct": 0, "long_pnl_pct": 0, "short_pnl_pct": 0, "liquidation_distance": 1, "position_age_hours": 0, "long_net_funding_usd": 0, "short_net_funding_usd": 0, "short_funding_rate": 0, "long_funding_rate": 0, "current_long_price": 0, "current_short_price": 0, "entry_long_price": 0, "entry_short_price": 0, "position_size_usd": 0, "entry_fees_paid_usd": 0, "is_active": false, "hours_held": 0, "net_funding_ratio": 0, "funding_rate": 0, "current_spread_pct": 0, "entry_spread_pct": 0, "value_to_capital_ratio": 0, "funding_efficiency": 0, "liquidation_distance_pct": 1, "pnl_pct": 0, "total_net_funding_usd": 0, "position_is_active": 0}, {"unrealized_pnl_pct": 0, "long_pnl_pct": 0, "short_pnl_pct": 0, "liquidation_distance": 1, "position_age_hours": 0, "long_net_funding_usd": 0, "short_net_funding_usd": 0, "short_funding_rate": 0, "long_funding_rate": 0, "current_long_price": 0, "current_short_price": 0, "entry_long_price": 0, "entry_short_price": 0, "position_size_usd": 0, "entry_fees_paid_usd": 0, "is_active": false, "hours_held": 0, "net_funding_ratio": 0, "funding_rate": 0, "current_spread_pct": 0, "entry_spread_pct": 0, "value_to_capital_ratio": 0, "funding_efficiency": 0, "liquidation_distance_pct": 1, "pnl_pct": 0, "total_net_funding_usd": 0, "position_is_active": 0}, {"unrealized_pnl_pct": 0, "long_pnl_pct": 0, "short_pnl_pct": 0, "liquidation_distance": 1, "position_age_hours": 0, "long_net_funding_usd": 0, "short_net_funding_usd": 0, "short_funding_rate": 0, "long_funding_rate": 0, "current_long_price": 0, "current_short_price": 0, "entry_long_price": 0, "entry_short_price": 0, "position_size_usd": 0, "entry_fees_paid_usd": 0, "is_active": false, "hours_held": 0, "net_funding_ratio": 0, "funding_rate": 0, "current_spread_pct": 0, "entry_spread_pct": 0, "value_to_capital_ratio": 0, "funding_efficiency": 0, "liquidation_distance_pct": 1, "pnl_pct": 0, "total_net_funding_usd": 0, "position_is_active": 0}, {"unrealized_pnl_pct": 0, "long_pnl_pct": 0, "short_pnl_pct": 0, "liquidation_distance": 1, "position_age_hours": 0, "long_net_funding_usd": 0, "short_net_funding_usd": 0, "short_funding_rate": 0, "long_funding_rate": 0, "current_long_price": 0, "current_short_price": 0, "entry_long_price": 0, "entry_short_price": 0, "position_size_usd": 0, "entry_fees_paid_usd": 0, "is_active": false, "hours_held": 0, "net_funding_ratio": 0, "funding_rate": 0, "current_spread_pct": 0, "entry_spread_pct": 0, "value_to_capital_ratio": 0, "funding_efficiency": 0, "liquidation_distance_pct": 1, "pnl_pct": 0, "total_net_funding_usd": 0, "position_is_active": 0}, {"unrealized_pnl_pct": 0, "long_pnl_pct": 0, "short_pnl_pct": 0, "liquidation_distance": 1, "position_age_hours": 0, "long_net_funding_usd": 0, "short_net_funding_usd": 0, "short_funding_rate": 0, "long_funding_rate": 0, "current_long_price": 0, "current_short_price": 0, "entry_long_price": 0, "entry_short_price": 0, "position_size_usd": 0, "entry_fees_paid_usd": 0, "is_active": false, "hours_held": 0, "net_funding_ratio": 0, "funding_rate": 0, "current_spread_pct": 0, "entry_spread_pct": 0, "value_to_capital_ratio": 0, "funding_efficiency": 0, "liquidation_distance_pct": 1, "pnl_pct": 0, "total_net_funding_usd": 0, "position_is_active": 0}]}, "trading_config": {"max_leverage": 2.0, "target_utilization": 0.9, "max_positions": 2, "stop_loss_threshold": -0.02, "liquidation_buffer": 0.15}}, "response": {"action": "ENTER", "action_id": 1, "confidence": 0.5462167859077454, "state_value": 0.6818320751190186, "action_probabilities": [0.0031938208267092705, 0.5462167859077454, 0.01833476312458515, 0.012993412092328072, 0.008681464940309525, 0.0011926749721169472, 0.007464228197932243, 0.03425908461213112, 0.06786879152059555, 0.0, 0.0, 0.11030309647321701, 0.00221248809248209, 0.00256561697460711, 0.012301544658839703, 0.009987959638237953, 0.018678463995456696, 0.0030953860841691494, 0.002642568899318576, 0.0, 0.0, 0.04049716144800186, 0.02627200447022915, 0.001025915495119989, 0.019275177270174026, 0.004581420682370663, 0.04215671867132187, 0.0007607016013935208, 0.0034388010390102863, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "opportunity_index": 0, "opportunity_symbol": "0GUSDT", "position_size": "SMALL", "size_multiplier": 0.1, "model_info": {"model_type": "ModularPPO", "architecture": "modular_network_with_attention", "action_space": 36, "observation_space": 275, "max_opportunities": 10, "max_positions": 5, "network_parameters": 791989}}}"""

# Split by newlines and parse each JSON object
lines = [line.strip() for line in raw_data.strip().split('\n') if line.strip()]
data = [json.loads(line) for line in lines]

# Write formatted JSON to file
with open('formatted_ml_decisions_final.json', 'w') as f:
    json.dump(data, f, indent=2)

print(f"Formatted {len(data)} decision entries")
print("Output saved to: formatted_ml_decisions_final.json")
